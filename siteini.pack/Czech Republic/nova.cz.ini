**------------------------------------------------------------------------------------------------
* @header_start
* WebGrab+Plus ini for grabbing EPG data from TvGuide websites
* @Site: nova.cz
* @MinSWversion: V2.1
* @Revision 0 - [30/10/2021] doglover
* @Remarks:
*   none
* @header_end
**------------------------------------------------------------------------------------------------
site {url=tv.nova.cz|timezone=Europe/Prague|maxdays=7.1|cultureinfo=cs-CZ|charset=UTF-8|titlematchfactor=90|keepindexpage}
url_index{url ()|https://tv.nova.cz/program#}
url_index.headers {customheader=Accept-Encoding=gzip,deflate}
urldate.format {datenumber|unix|0}
index_variable_element.modify {set|'config_site_id'}
scope.range {(datelogo)|end}
index_urlchannellogo.scrub {single|var EPG_channels|"'index_variable_element'":{|}|;}
index_urlchannellogo.modify {substring (type=regex)|"\"logo\":\"(.*)\""}
end_scope

index_showsplit.scrub {multi (separator="},{") |var EPG_program|"'index_variable_element'":[|]|</script>}

index_start.scrub {single ()|"start_at":"||",|",}
index_stop.scrub {single ()|"end-at":"||",|",}
index_title.scrub {single|"title":"||",|",}
*index_subtitle.scrub {single ()|"short_description":"||",|",}
*index_subtitle.modify {replace|\\n|##BR##}
*index_subtitle.modify {remove|\\t}
*index_subtitle.modify {remove|\\r}
*index_subtitle.modify {cleanup(tags="<"">")}
*index_subtitle.modify {cleanup} 
index_description.scrub {multi ()|"description":"||",|",}
index_description.modify {replace|\\n|##BR##}
index_description.modify {remove|\\t}
index_description.modify {remove|\\r}
index_description.modify {cleanup(tags="<"">")}
index_description.modify {cleanup} 
*index_subtitle.modify {clear ('index_subtitle' = 'index_description')}
index_description.modify {replace|##BR##|\n}
index_showicon.scrub {single|"image":"||",|",}
**  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _  _
**      #####  CHANNEL FILE CREATION (only to create the xxx-channel.xml file)
**
** @auto_xml_channel_start
*index_site_channel.scrub {multi (separator="},")|var EPG_channels = {|||;}
*index_site_id.scrub {multi ()|}
*index_site_id.modify {substring ( type=regex)|'index_site_channel' "(\d+)":}
*index_site_channel.modify {substring (type=regex)|'index_site_channel' "\"title\":\"(.*)\","}
*index_site_channel.modify {cleanup}
*index_site_id.modify {cleanup(removeduplicates=equal,100 link="index_site_channel")}
*end_scope
** @auto_xml_channel_end


index_temp_2.modify {calculate(format=F0 type=char)|'index_description' #}
loop{('index_temp_2' > "2300")|end}
index_description.modify {remove(type=sentence)|-1 1}
index_temp_2.modify {calculate(format=F0 type=char)|'index_description' #}
end_loop
index_title.modify {substring(type=char)|'index_title' 0 80}
index_subtitle.modify {substring(type=char)|'index_subtitle' 0 160}


